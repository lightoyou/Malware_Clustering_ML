#!/usr/bin/env python
#-*- coding: utf-8 -*-
import os
import lief
from lief import to_json
import json
import pprint

import numpy as np


pp = pprint.PrettyPrinter(indent=4)

AllFile = []
AllPE = []

PathDataset = "dataset/"


#data_directories
for root, subFolders, files in os.walk(PathDataset):
    for file in files:
        PathDataset = os.path.join(root, file)
        AllFile.append(PathDataset)



for p in AllFile:
    try:
        pe = lief.parse(p)
        dos_header = to_json(pe.dos_header)
        header = to_json(pe.header)
        optional_header = to_json(pe.optional_header)
        print("DOS_HEADER")
        pp.pprint(json.loads(dos_header))
        print("HEADER")
        pp.pprint(json.loads(header))
        print("OPTIONAL HEADER")
        pp.pprint(json.loads(optional_header))

        AllPE.append(pe)
    except:
        pass
